{
  "screens": [
    {
      "id": "screen.home",
      "route": "/",
      "title": "Home",
      "layout": {
        "type": "Column",
        "props": {
          "id": "home-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "ホーム",
              "slot": "header"
            }
          },
          {
            "type": "Row",
            "props": {
              "gap": 16
            },
            "children": [
              {
                "type": "Column",
                "props": {
                  "gap": 12,
                  "flex": 3
                },
                "children": [
                  {
                    "type": "Card",
                    "props": {
                      "padding": 12
                    },
                    "children": [
                      {
                        "type": "PostComposer",
                        "props": {
                          "id": "home-composer",
                          "defaultVisibility": "public",
                          "onPosted": {
                            "type": "refresh",
                            "target": "home-feed"
                          }
                        }
                      }
                    ]
                  },
                  {
                    "type": "StoriesBar",
                    "props": {
                      "id": "stories"
                    }
                  },
                  {
                    "type": "PostFeed",
                    "props": {
                      "id": "home-feed",
                      "source": "home",
                      "emptyText": "まだ投稿がありません"
                    }
                  }
                ]
              },
              {
                "type": "Column",
                "props": {
                  "gap": 12,
                  "flex": 1,
                  "slot": "right-sidebar",
                  "id": "home-sidebar"
                },
                "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 12
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "クイックアクセス",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "Button",
                    "props": {
                      "text": "投稿する",
                      "variant": "primary",
                      "fullWidth": true,
                      "action": "openComposer"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/stories",
                      "text": "ストーリーを見る"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/communities",
                      "text": "コミュニティ"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/storage",
                      "text": "ストレージ"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/settings",
                      "text": "設定"
                    }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.channel",
      "route": "/c/:id",
      "title": "Community",
      "layout": {
        "type": "Column",
        "props": {
          "id": "community-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "コミュニティ",
              "backHref": "/connections",
              "slot": "header"
            }
          },
          {
            "type": "Row",
            "props": {
              "gap": 16
            },
            "children": [
              {
                "type": "Column",
                "props": {
                  "gap": 12,
                  "flex": 3
                },
                "children": [
                  {
                    "type": "Card",
                    "props": {
                      "padding": 12
                    },
                    "children": [
                      {
                        "type": "PostComposer",
                        "props": {
                          "id": "community-composer",
                          "endpoint": "/communities/{{routeParams.id}}/posts",
                          "defaultVisibility": "public",
                          "onPosted": {
                            "type": "refresh",
                            "target": "community-feed"
                          }
                        }
                      }
                    ]
                  },
                  {
                    "type": "StoriesBar",
                    "props": {
                      "id": "community-stories",
                      "communityId": "{{routeParams.id}}"
                    }
                  },
                  {
                    "type": "PostFeed",
                    "props": {
                      "id": "community-feed",
                      "source": "community",
                      "communityId": "{{routeParams.id}}",
                      "emptyText": "このコミュニティにはまだ投稿がありません"
                    }
                  }
                ]
              },
              {
                "type": "Column",
                "props": {
                  "gap": 12,
                  "flex": 1,
                  "slot": "community-sidebar",
                  "id": "community-sidebar"
                },
                "children": [
                  {
                    "type": "Card",
                    "props": {
                      "padding": 12
                    },
                    "children": [
                      {
                        "type": "Text",
                        "props": {
                          "text": "コミュニティ ID",
                          "variant": "subtitle"
                        }
                      },
                      {
                        "type": "Text",
                        "props": {
                          "text": "{{routeParams.id}}"
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.dm_list",
      "route": "/chat",
      "title": "Chat",
      "state": {
        "activeThreadId": {
          "default": ""
        },
        "activeRecipients": {
          "default": []
        }
      },
      "layout": {
        "type": "Column",
        "props": {
          "id": "chat-root",
          "gap": 12
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "メッセージ",
              "slot": "header"
            }
          },
          {
            "type": "Row",
            "props": {
              "gap": 12
            },
            "children": [
              {
                "type": "Column",
                "props": {
                  "gap": 12,
                  "flex": 1
                },
                "children": [
                  {
                    "type": "Card",
                    "props": {
                      "padding": 12
                    },
                    "children": [
                      {
                        "type": "Text",
                        "props": {
                          "text": "DMスレッド",
                          "variant": "subtitle"
                        }
                      },
                      {
                        "type": "ThreadList",
                        "props": {
                          "id": "dmThreads",
                          "emptyText": "メッセージはまだありません"
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "type": "Column",
                "props": {
                  "gap": 12,
                  "flex": 2
                },
                "children": [
                  {
                    "type": "Conditional",
                    "props": {
                      "if": {
                        "$state": "activeThreadId"
                      }
                    },
                    "children": [
                      {
                        "type": "Card",
                        "props": {
                          "padding": 12
                        },
                        "children": [
                          {
                            "type": "Text",
                            "props": {
                              "text": "スレッド",
                              "variant": "subtitle"
                            }
                          },
                          {
                            "type": "MessageThread",
                            "props": {
                              "id": "dmMessages",
                              "emptyText": "メッセージはまだありません"
                            }
                          },
                          {
                            "type": "MessageComposer",
                            "props": {
                              "placeholder": "メッセージを入力"
                            }
                          }
                        ]
                      }
                    ],
                    "else": [
                      {
                        "type": "Placeholder",
                        "props": {
                          "text": "左のスレッドから選択してください"
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.dm_thread",
      "route": "/chat/dm/:id",
      "title": "Direct Message",
      "layout": {
        "type": "Column",
        "props": {
          "id": "dm-thread-root",
          "gap": 12
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "DM",
              "backHref": "/chat",
              "slot": "header"
            }
          },
          {
            "type": "Card",
            "props": {
              "padding": 12
            },
            "children": [
              {
                "type": "MessageThread",
                "props": {
                  "id": "dmThreadMessages",
                  "emptyText": "メッセージはまだありません"
                }
              },
              {
                "type": "MessageComposer",
                "props": {
                  "placeholder": "メッセージを入力"
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.dm_legacy",
      "route": "/dm",
      "title": "Direct Messages",
      "layout": {
        "type": "Column",
        "props": {
          "id": "dm-redirect",
          "gap": 12
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "DM",
              "slot": "header"
            }
          },
          {
            "type": "Placeholder",
            "props": {
              "text": "DM は /chat に統合されています。"
            }
          },
          {
            "type": "NavLink",
            "props": {
              "href": "/chat",
              "text": "チャットに移動"
            }
          }
        ]
      }
    },
    {
      "id": "screen.community",
      "route": "/communities",
      "title": "Communities",
      "layout": {
        "type": "Column",
        "props": {
          "id": "communities-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "コミュニティ",
              "slot": "header"
            }
          },
          {
            "type": "CommunityList",
            "props": {
              "id": "community-list",
              "showJoined": true,
              "emptyText": "まだコミュニティに参加していません"
            }
          }
        ]
      }
    },
    {
      "id": "screen.connections",
      "route": "/connections",
      "title": "Connections",
      "layout": {
        "type": "Column",
        "props": {
          "id": "connections-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "つながり",
              "slot": "header"
            }
          },
          {
            "type": "Row",
            "props": {
              "gap": 12
            },
            "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 12,
                  "shadow": true,
                  "flex": 2
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "友達",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "FriendList",
                    "props": {
                      "id": "friends",
                      "emptyText": "まだ友達がいません"
                    }
                  }
                ]
              },
              {
                "type": "Card",
                "props": {
                  "padding": 12,
                  "shadow": true,
                  "flex": 1
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "アクション",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/follow-requests",
                      "text": "フォロー申請"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/invitations",
                      "text": "コミュニティ招待"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/users",
                      "text": "ユーザー検索"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.stories",
      "route": "/stories",
      "title": "Stories",
      "layout": {
        "type": "Column",
        "props": {
          "id": "stories-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "ストーリー",
              "slot": "header"
            }
          },
          {
            "type": "StoriesBar",
            "props": {
              "id": "stories-bar"
            }
          },
          {
            "type": "ApiList",
            "props": {
              "id": "stories-list",
              "path": "/stories",
              "emptyText": "ストーリーはありません"
            },
            "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 12,
                  "shadow": false
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{item.author_id}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{item.user_id}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{item.caption}}"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{item.created_at}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/stories/{{item.id}}",
                      "text": "詳細を開く"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.story_viewer",
      "route": "/stories/:id",
      "title": "Story",
      "layout": {
        "type": "Column",
        "props": {
          "id": "story-viewer-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "ストーリー",
              "backHref": "/stories",
              "slot": "header"
            }
          },
          {
            "type": "ApiData",
            "props": {
              "id": "story-viewer-data",
              "path": "/stories/{{routeParams.id}}"
            },
            "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 12
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.author_id}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.caption}}"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.created_at}}",
                      "variant": "subtitle"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.compose",
      "route": "/compose",
      "title": "Compose",
      "layout": {
        "type": "Column",
        "props": {
          "id": "compose-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "新規投稿",
              "backHref": "/",
              "slot": "header"
            }
          },
          {
            "type": "Card",
            "props": {
              "padding": 12
            },
            "children": [
              {
                "type": "PostComposer",
                "props": {
                  "id": "compose-composer",
                  "defaultVisibility": "public"
                }
              }
            ]
          },
          {
            "type": "ApiList",
            "props": {
              "id": "drafts",
              "path": "/post-plans?status=draft",
              "emptyText": "下書きはありません"
            },
            "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 10,
                  "shadow": false
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{item.text}}",
                      "variant": "body"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{item.scheduled_at}}",
                      "variant": "subtitle"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.post_detail",
      "route": "/posts/:id",
      "title": "Post",
      "layout": {
        "type": "Column",
        "props": {
          "id": "post-detail-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "投稿",
              "backHref": "/",
              "slot": "header"
            }
          },
          {
            "type": "ApiData",
            "props": {
              "path": "/posts/{{routeParams.id}}"
            },
            "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 12
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.author_id}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.text}}"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.created_at}}",
                      "variant": "subtitle"
                    }
                  }
                ]
              }
            ]
          },
          {
            "type": "CommentForm",
            "props": {
              "endpoint": "/posts/{{routeParams.id}}/comments",
              "autoFocus": true
            }
          },
          {
            "type": "CommentList",
            "props": {
              "id": "comments",
              "endpoint": "/posts/{{routeParams.id}}/comments"
            }
          }
        ]
      }
    },
    {
      "id": "screen.profile",
      "route": "/profile",
      "title": "Profile",
      "layout": {
        "type": "Column",
        "props": {
          "id": "profile-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "プロフィール",
              "slot": "header"
            }
          },
          {
            "type": "ApiData",
            "props": {
              "path": "/me"
            },
            "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 12
                },
                "children": [
                  {
                    "type": "UserAvatar",
                    "props": {
                      "src": "{{data.avatar_url}}",
                      "size": "lg",
                      "alt": "{{data.display_name}}"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.display_name}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.handle}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "Text",
                    "props": {
                      "text": "{{data.id}}",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/profile/edit",
                      "text": "プロフィール編集"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.profile_edit",
      "route": "/profile/edit",
      "title": "Edit Profile",
      "layout": {
        "type": "Column",
        "props": {
          "id": "profile-edit-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "プロフィール編集",
              "backHref": "/profile",
              "slot": "header"
            }
          },
          {
            "type": "Form",
            "props": {
              "gap": 12,
              "onSubmit": {
                "type": "api",
                "method": "PATCH",
                "endpoint": "/me",
                "body": {
                  "display_name": "{{form.values.display_name}}",
                  "avatar_url": "{{form.values.avatar_url}}"
                },
                "onSuccess": {
                  "type": "navigate",
                  "to": "/profile"
                }
              }
            },
            "children": [
              {
                "type": "Input",
                "props": {
                  "name": "display_name",
                  "placeholder": "表示名",
                  "required": true
                }
              },
              {
                "type": "Input",
                "props": {
                  "name": "avatar_url",
                  "placeholder": "アバターURL"
                }
              },
              {
                "type": "Button",
                "props": {
                  "text": "保存",
                  "submit": true,
                  "loadingText": "保存中..."
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.settings",
      "route": "/settings",
      "title": "Settings",
      "layout": {
        "type": "Column",
        "props": {
          "id": "settings-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "設定",
              "backHref": "/",
              "slot": "header"
            }
          },
          {
            "type": "Row",
            "props": {
              "gap": 12
            },
            "children": [
              {
                "type": "Card",
                "props": {
                  "padding": 12
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "アカウント",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/profile",
                      "text": "プロフィールを見る"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/profile/edit",
                      "text": "プロフィール編集"
                    }
                  }
                ]
              },
              {
                "type": "Card",
                "props": {
                  "padding": 12
                },
                "children": [
                  {
                    "type": "Text",
                    "props": {
                      "text": "通知",
                      "variant": "subtitle"
                    }
                  },
                  {
                    "type": "NavLink",
                    "props": {
                      "href": "/notifications",
                      "text": "通知を見る"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.users",
      "route": "/users",
      "title": "User Search",
      "state": {
        "userQuery": {
          "default": ""
        }
      },
      "layout": {
        "type": "Column",
        "props": {
          "id": "users-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "ユーザー検索",
              "slot": "header"
            }
          },
          {
            "type": "Form",
            "props": {
              "gap": 8,
              "onSubmit": {
                "type": "setState",
                "key": "userQuery",
                "value": "{{form.values.query}}"
              }
            },
            "children": [
              {
                "type": "Input",
                "props": {
                  "name": "query",
                  "placeholder": "@handle や名前を入力",
                  "required": true
                }
              },
              {
                "type": "Button",
                "props": {
                  "text": "検索",
                  "submit": true
                }
              }
            ]
          },
          {
            "type": "UserSearchResults",
            "props": {
              "id": "user-search-results",
              "emptyText": "ユーザーが見つかりません"
            }
          }
        ]
      }
    },
    {
      "id": "screen.invitations",
      "route": "/invitations",
      "title": "Invitations",
      "layout": {
        "type": "Column",
        "props": {
          "id": "invitations-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "招待",
              "slot": "header"
            }
          },
          {
            "type": "InvitationList",
            "props": {
              "id": "invitations-list",
              "emptyText": "招待はありません"
            }
          }
        ]
      }
    },
    {
      "id": "screen.follow_requests",
      "route": "/follow-requests",
      "title": "Follow Requests",
      "layout": {
        "type": "Column",
        "props": {
          "id": "follow-requests-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "フォローリクエスト",
              "slot": "header"
            }
          },
          {
            "type": "FollowRequestList",
            "props": {
              "id": "follow-requests",
              "emptyText": "リクエストはありません"
            }
          }
        ]
      }
    },
    {
      "id": "screen.notifications",
      "route": "/notifications",
      "title": "Notifications",
      "layout": {
        "type": "Column",
        "props": {
          "id": "notifications-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "通知",
              "slot": "header"
            }
          },
          {
            "type": "NotificationList",
            "props": {
              "id": "notifications-list",
              "groupByDate": true,
              "emptyText": "通知はありません"
            }
          }
        ]
      }
    },
    {
      "id": "screen.onboarding",
      "route": "/onboarding",
      "title": "Onboarding",
      "layout": {
        "type": "Column",
        "props": {
          "id": "onboarding-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "はじめに",
              "slot": "header"
            }
          },
          {
            "type": "Form",
            "props": {
              "gap": 12,
              "onSubmit": {
                "type": "api",
                "method": "PATCH",
                "endpoint": "/me",
                "body": {
                  "display_name": "{{form.values.display_name}}"
                },
                "onSuccess": {
                  "type": "navigate",
                  "to": "/"
                }
              }
            },
            "children": [
              {
                "type": "Input",
                "props": {
                  "name": "display_name",
                  "placeholder": "表示名を入力",
                  "required": true
                }
              },
              {
                "type": "Button",
                "props": {
                  "text": "開始する",
                  "submit": true
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.user_profile",
      "route": "/@:handle",
      "auth": "public",
      "title": "User Profile",
      "layout": {
        "type": "Column",
        "props": {
          "id": "user-profile-root",
          "gap": 16,
          "padding": 16
        },
        "children": [
          {
            "type": "UserProfileView",
            "props": {
              "id": "user-profile",
              "handle": "{{routeParams.handle}}"
            }
          }
        ]
      }
    },
    {
      "id": "screen.storage",
      "route": "/storage",
      "title": "Storage",
      "layout": {
        "type": "Column",
        "props": {
          "id": "storage-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "ストレージ",
              "slot": "header",
              "backHref": "/"
            }
          },
          {
            "type": "Card",
            "props": {
              "padding": 12
            },
            "children": [
              {
                "type": "Text",
                "props": {
                  "text": "ファイルとフォルダを管理します",
                  "variant": "subtitle"
                }
              },
              {
                "type": "NavLink",
                "props": {
                  "href": "/storage/root",
                  "text": "ルートフォルダを開く"
                }
              },
              {
                "type": "NavLink",
                "props": {
                  "href": "/storage/uploads",
                  "text": "アップロード済み"
                }
              },
              {
                "type": "NavLink",
                "props": {
                  "href": "/storage/shared",
                  "text": "共有アイテム"
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "screen.storage_folder",
      "route": "/storage/:folderId",
      "title": "Folder",
      "layout": {
        "type": "Column",
        "props": {
          "id": "storage-folder-root",
          "gap": 16
        },
        "children": [
          {
            "type": "Header",
            "props": {
              "title": "フォルダ",
              "backHref": "/storage",
              "slot": "header"
            }
          },
          {
            "type": "Card",
            "props": {
              "padding": 12
            },
            "children": [
              {
                "type": "Text",
                "props": {
                  "text": "フォルダ ID: {{routeParams.folderId}}",
                  "variant": "subtitle"
                }
              },
              {
                "type": "Placeholder",
                "props": {
                  "text": "ファイル一覧は実装予定"
                }
              }
            ]
          }
        ]
      }
    }
  ]
}
