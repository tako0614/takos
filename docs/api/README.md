# takos REST API Reference

takos REST API の完全なリファレンスドキュメントです。

## 概要

takos は ActivityPub 対応の分散型 SNS バックエンドです。このドキュメントでは、クライアントアプリケーション（Web フロントエンド、モバイルアプリ等）から利用する REST API について説明します。

**Base URL**: `https://{instance-domain}/`

## 認証

ほとんどのエンドポイントは認証が必要です。takos は以下の認証方式をサポートします：

- **Bearer Token (JWT)**: `Authorization: Bearer <token>` ヘッダー
- **Session Cookie**: `takos-session` cookie

詳細は [認証ガイド](./auth.md) を参照してください。

## エンドポイント一覧

### 認証
- [認証 API](./auth.md) - ログイン、トークン発行、ログアウト

### ユーザー
- [ユーザー API](./users.md) - プロフィール、検索、フレンド機能

### 投稿
- [投稿 API](./posts.md) - テキスト・メディア投稿、リアクション、コメント

### ストーリー
- [ストーリー API](./stories.md) - ビジュアルストーリー作成・閲覧

### コミュニティ
- [コミュニティ API](./communities.md) - コミュニティ作成・管理、チャンネル、招待

### チャット/DM
- [チャット API](./chat.md) - ダイレクトメッセージ、チャンネルメッセージ

### 通知
- [通知 API](./notifications.md) - 通知一覧、既読管理、プッシュ通知

### メディア
- [メディア API](./media.md) - 画像・動画アップロード、ストレージ管理

### オーナー設定
- [takos-config エクスポート/インポート](./config.md) - オーナー向け構成 API と CLI

## レスポンス形式

### 成功レスポンス

```json
{
  "ok": true,
  "data": { ... }
}
```

### エラーレスポンス

```json
{
  "ok": false,
  "error": "エラーメッセージ"
}
```

## HTTP ステータスコード

| コード | 意味 |
|-------|------|
| 200 | 成功 |
| 201 | 作成成功 |
| 400 | リクエスト不正 |
| 401 | 認証が必要 |
| 403 | 権限がない |
| 404 | リソースが見つからない |
| 429 | レート制限超過 |
| 500 | サーバーエラー |

## ページネーション

一部のエンドポイントはページネーションをサポートしています。

**クエリパラメータ**:
- `limit`: 取得件数（デフォルト: 50、最大: 100）
- `offset`: スキップ件数（デフォルト: 0）

## レート制限

以下のレート制限が適用されます：

- ActivityPub Inbox: 100リクエスト/分/IP
- WebFinger: 60リクエスト/分/IP
- その他の REST API: 制限なし（将来実装予定）

レート制限超過時は `429 Too Many Requests` が返されます。

## CORS

takos は CORS をサポートしています。`Origin` ヘッダーがある場合、そのオリジンがミラーバックされます。

## バージョニング

現在、API バージョニングは実装されていません。後方互換性のない変更が入る場合は、事前に告知されます。

## 関連ドキュメント

- [ActivityPub 仕様](../activitypub.md) - フェデレーション用 ActivityPub エンドポイント
- [プッシュ通知サービス](../push-service.md) - プッシュ通知の仕様
